{% extends 'base.html.twig' %}

{% block title %}Messagerie
{% endblock %}

{% block body %}
	<section class="container">
		<div class="offcanvas offcanvas-start" data-bs-scroll="true" tabindex="-1" id="offcanvasWithBothOptions"
  aria-labelledby="offcanvasWithBothOptionsLabel">
  <div class="offcanvas-header">
    <h3 class="offcanvas-title" id="offcanvasWithBothOptionsLabel">Mon Profile</h3>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <hr class="dropdown-divider">
  <div class="offcanvas-body ">
    <ul class=" navbar-nav me-auto mb-2 mb-lg-0 ">
      <li class="nav-item">
        <a href="{{path('profile_info')}}" class="nav-link coloredTitle"><i class="fas fa-xl fa-circle-info"></i> Mes
          informations</a>
      </li>
      <li class="nav-item">
        <a href="{{path('profile_gerermonadresse')}}" class="nav-link coloredTitle"><i
            class="fas fa-xl fa-location-dot"></i> Gerer mon adresse</a>
      </li>
      <li class="nav-item">
        <a href="{{path('profile_annonces')}}" class="nav-link coloredTitle"><i class="fas fa-xl fa-bullhorn"></i> Mes
          annonces</a>
      </li>
      <li class="nav-item">
        <a href="{{path('profile_mesFavoris')}}" class="nav-link coloredTitle"> <i class="fas fa-xl fa-heart"></i> Mes
          favoris</a>
      </li>
      <li class="nav-item">
        <a href="{{path('messenger_received')}}" class="nav-link coloredTitle"> <i class="fas fa-xl fa-message"></i>
          Messagerie</a>
      </li>
    </ul>
  </div>
</div>
<div class='d-flex row left'>
  <div>
    <a class='my-4' href="{{path('profile_profile')}}">Retourner a mon profile <i class="fas fa-arrow-rotate-left"></i></a>
  </div>
  <button class="btn btn-primary m-3" type="button" data-bs-toggle="offcanvas"
    data-bs-target="#offcanvasWithBothOptions" aria-controls="offcanvasWithBothOptions">Mon menu</button>
			<div class="col-12">
				<h1>Messagerie</h1>
				<h2>Boîte de réception</h2>
				<p>Vous avez reçu
					{{ app.user.received|length }}
					messages</p>
			</div>
			<div class="table-responsive">
							{% if app.user.received|length >0 %}
			<table class="table caption-top">
				<caption>Message Réçu</caption>
				<thead>
				  <tr>
					<th scope="col"></th>
					<th scope="col">De</th>
					<th scope="col">Sujet</th>
					<th scope="col">Date</th>
					<th scope="col">Action</th>
				  </tr>
				</thead>
				{% for message in app.user.received %}
				{% set bold = "" %}
				{% if message.isRead == 0 %}
				{% set bold = "fw-bold" %}
				{% endif %}
				<tbody>
				  <tr>
					<th scope="row"></th>
					<td class=" {{bold}}"><a href="{{ path('messenger_read', {id: message.id}) }}">{{ message.envoyeur.nomEtprenom() }}</a></td>
					<td class=" {{bold}}"><a href="{{ path('messenger_read', {id: message.id}) }}">{{ message.titre }}</a></td>
					<td class=" {{bold}}"><a href="{{ path('messenger_read', {id: message.id}) }}">{{ message.date|ago ( locale = "fr")}}</a></td>
					<td class=" {{bold}}"><a href="{{ path('messenger_delete', {id: message.id})}}"> <i class="fas fa-trash" aria-hidden="true"></i></a></td>
				  </tr>
				</tbody>
				{% endfor %}
			  </table>
			</div>
			
			  {%else%}
			  <img style="width:50%;" src="{{asset('images/messagerie.png')}}" alt="image enveloppe" srcset="">
			  {%endif%}


	</div>
{% endblock %}